<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.20"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Using the Wwise Authoring API in Wwise Plug-ins</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="akdoxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Wwise SDK 2023.1.0 - Windows
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.20 -->
</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Using the Wwise Authoring API in Wwise Plug-ins </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="waapi_plugin_rpc"></a>
Calling a remote procedure</h1>
<p>The Wwise Authoring API can be used to issue remote procedure calls from within a Wwise plug-in using the <code>AK::Wwise::Plugin::Host::WaapiCall()</code> method. This method is provided by the Host component, which you can request by inheriting from <code>AK::Wwise::Plugin::RequestHost</code>.</p>
<table border="0" cellspacing="0" cellpadding="2">
<tr>
<td valign="top"><img src="images/Note.gif" alt="" class="inline"/></td><td><b>Note:</b> Calls to the <code>AK::Wwise::Plugin::Host::WaapiCall()</code> method are always blocking. </td></tr>
</table>
<p>Utility classes are provided so that callers can provide a strategy for memory allocation. <code><a class="el" href="class_a_k_1_1_wwise_1_1_mallocator.html">AK::Wwise::Mallocator</a></code> offers a default implementation using functions from the C library, such as <code>malloc</code>, <code>free</code> and <code>realloc</code>. A custom strategy can easily be provided by defining a class that implements <code><a class="el" href="class_a_k_1_1_i_ak_plugin_mem_alloc.html">AK::IAkPluginMemAlloc</a></code>. Finally, a wrapper class <code><a class="el" href="class_a_k_1_1_wwise_1_1_safe_allocator.html">AK::Wwise::SafeAllocator</a></code> is used to ensure type-safety and automatic memory management.</p>
<p>Examples:</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="_ak_allocator_8h.html">AK/Tools/Common/AkAllocator.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;rapidjson/document.h&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">// Use the default allocation strategy for results and errors</span></div>
<div class="line"><a class="code" href="class_a_k_1_1_wwise_1_1_mallocator.html">AK::Wwise::Mallocator</a> alloc;</div>
<div class="line"> </div>
<div class="line"><a class="code" href="class_a_k_1_1_wwise_1_1_safe_allocator.html">AK::Wwise::SafeAllocator&lt;char&gt;</a> szResults(&amp;alloc);</div>
<div class="line"><a class="code" href="class_a_k_1_1_wwise_1_1_safe_allocator.html">AK::Wwise::SafeAllocator&lt;char&gt;</a> szError(&amp;alloc);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Issue a remote procedure call to the Wwise Authoring API</span></div>
<div class="line">m_host.WaapiCall(<span class="stringliteral">&quot;ak.wwise.core.getInfo&quot;</span>, NULL, NULL, alloc, szResults, szError);</div>
<div class="line"><span class="keywordflow">if</span> (!szError)</div>
<div class="line">{</div>
<div class="line">    <span class="comment">// Parse the results JSON string</span></div>
<div class="line">    rapidjson::Document results;</div>
<div class="line">    results.Parse(szResults);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// ...</span></div>
<div class="line">}</div>
</div><!-- fragment --><div class="fragment"><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="_ak_allocator_8h.html">AK/Tools/Common/AkAllocator.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;rapidjson/document.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;rapidjson/stringbuffer.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;rapidjson/writer.h&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">// Use the default allocation strategy for results and errors</span></div>
<div class="line"><a class="code" href="class_a_k_1_1_wwise_1_1_mallocator.html">AK::Wwise::Mallocator</a> alloc;</div>
<div class="line"> </div>
<div class="line"><a class="code" href="class_a_k_1_1_wwise_1_1_safe_allocator.html">AK::Wwise::SafeAllocator&lt;char&gt;</a> szResults(&amp;alloc);</div>
<div class="line"><a class="code" href="class_a_k_1_1_wwise_1_1_safe_allocator.html">AK::Wwise::SafeAllocator&lt;char&gt;</a> szError(&amp;alloc);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Build a JSON object that contains the procedure&#39;s parameters</span></div>
<div class="line">rapidjson::Document args;</div>
<div class="line">args.SetObject();</div>
<div class="line">args.AddMember(<span class="stringliteral">&quot;classId&quot;</span>, 8192003, args.GetAllocator());</div>
<div class="line">args.AddMember(<span class="stringliteral">&quot;property&quot;</span>, <span class="stringliteral">&quot;ModDepth&quot;</span>, args.GetAllocator());</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Stringify the JSON object</span></div>
<div class="line">rapidjson::StringBuffer buffer;</div>
<div class="line">rapidjson::Writer&lt;rapidjson::StringBuffer&gt; writer(buffer);</div>
<div class="line">args.Accept(writer);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Issue a remote procedure call to the Wwise Authoring API</span></div>
<div class="line">m_host.WaapiCall(<span class="stringliteral">&quot;ak.wwise.core.plugin.getProperty&quot;</span>, buffer.GetString(), NULL, alloc, szResults, szError);</div>
<div class="line"><span class="keywordflow">if</span> (!szError)</div>
<div class="line">{</div>
<div class="line">    <span class="comment">// Parse the results JSON string</span></div>
<div class="line">    rapidjson::Document results;</div>
<div class="line">    results.Parse(szResults);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// ...</span></div>
<div class="line">}</div>
</div><!-- fragment --><table border="0" cellspacing="0" cellpadding="2">
<tr>
<td valign="top"><img src="images/Note.gif" alt="" class="inline"/></td><td><b>Note:</b> Here, RapidJSON is only used for demonstration purposes and is in no way mandatory. </td></tr>
</table>
<p>Refer to <a class="el" href="plugin_dll.html">Authoring Plug-in Library Format</a> for more information on Wwise plug-ins. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<div class="ttc" id="a_common_2_ak_types_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname">NULL</div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> AkTypes.h:46</div></div>
<div class="ttc" id="aclass_a_k_1_1_wwise_1_1_mallocator_html"><div class="ttname"><a href="class_a_k_1_1_wwise_1_1_mallocator.html">AK.Wwise::Mallocator</a></div><div class="ttdef"><b>Definition:</b> AkAllocator.h:47</div></div>
<div class="ttc" id="aclass_a_k_1_1_wwise_1_1_safe_allocator_html"><div class="ttname"><a href="class_a_k_1_1_wwise_1_1_safe_allocator.html">AK.Wwise::SafeAllocator</a></div><div class="ttdef"><b>Definition:</b> AkAllocator.h:106</div></div>
<div class="ttc" id="a_ak_allocator_8h_html"><div class="ttname"><a href="_ak_allocator_8h.html">AkAllocator.h</a></div></div>
<div class="ttc" id="anamespace_a_k_1_1_wwise_1_1_plugin_1_1_xml_node_type_a2fa372cb0681531259c177a5938a22ff_html_a2fa372cb0681531259c177a5938a22ffafe099684193320746aae4bf5cd0258b7"><div class="ttname">AK.Wwise::Plugin::XmlNodeType::Document</div><div class="ttdeci">@ Document</div><div class="ttdef"><b>Definition:</b> HostXml.h:64</div></div>
</body>
</html>


<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.20"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Quick Start Sample Integration - MIDI</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="akdoxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Wwise SDK 2023.1.0 - Windows
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.20 -->
</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Quick Start Sample Integration - MIDI </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="soundengine_integration_midi"></a>
MIDI Integration Example</h1>
<p>MIDI events are posted by calling the AK::SoundEngine::PostMIDIOnEvent() function. The following code shows examples of:</p><ul>
<li>setting initial MIDI parameters,</li>
<li>posting MIDI events using the event's name (name given to the event by the Wwise user) or the event's ID as defined in "Wwise_IDs.h" (header file generated by Wwise).</li>
</ul>
<div class="fragment"><div class="line"><span class="preprocessor">#include &quot;Wwise_IDs.h&quot;</span> <span class="comment">// IDs generated by Wwise</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">// After Sound Engine initialization, register a global callback function.</span></div>
<div class="line"><span class="comment">// Be sure to register for callback just before the message queue is processed;</span></div>
<div class="line"><span class="comment">// this will ensure that any newly posted MIDI events are processed during</span></div>
<div class="line"><span class="comment">// the current frame (i.e. immediately after we exit our callback function).</span></div>
<div class="line">AK::SoundEngine::RegisterGlobalCallback( &amp;MIDICallback, AkGlobalCallbackLocation_PreProcessMessageQueueForRender )</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Obtain Sound Engine audio settings. These are required to determine the time</span></div>
<div class="line"><span class="comment">// equivalent of one audio frame.</span></div>
<div class="line"><a class="code" href="struct_ak_audio_settings.html">AkAudioSettings</a> audioSettings;</div>
<div class="line">AK::SoundEngine::GetAudioSettings( audioSettings );</div>
<div class="line"> </div>
<div class="line">(...)</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Callback function used to post MIDI events.</span></div>
<div class="line"><span class="keywordtype">void</span> MIDICallback( <span class="keywordtype">bool</span> in_bLastCall )</div>
<div class="line">{</div>
<div class="line">    <span class="comment">// Post MIDI event(s) if required.</span></div>
<div class="line">    <span class="comment">// Take extra care to ensure this code is thread-safe.</span></div>
<div class="line"> </div>
<div class="line">    <span class="comment">// For this example, assume we need to post the note-on and note-off</span></div>
<div class="line">    <span class="comment">// events for the same note.</span></div>
<div class="line">    <a class="code" href="struct_ak_m_i_d_i_post.html">AkMIDIPost</a> aPosts[2];</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">const</span> AkUInt8 byNote = 60;</div>
<div class="line">    <span class="keyword">const</span> AkUInt8 byChan = 0; <span class="comment">// Range 0-15 mapped to MIDI channel range 1-16.</span></div>
<div class="line"> </div>
<div class="line">    <span class="keyword">const</span> AkUInt32 uOnSamples = 0; <span class="comment">// Note will start at beginning of current frame.</span></div>
<div class="line">    <span class="keyword">const</span> AkUInt32 uOffSamples = uOnOffset + audioSettings.uNumSamplesPerFrame / 2;</div>
<div class="line">    <span class="comment">// Note will end mid-frame.</span></div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Note-on</span></div>
<div class="line">    <a class="code" href="struct_ak_m_i_d_i_post.html">AkMIDIPost</a>&amp; noteOn = aPosts[0];</div>
<div class="line">    noteOn.byType = AK_MIDI_EVENT_TYPE_NOTE_ON;</div>
<div class="line">    noteOn.byChan = byChan;</div>
<div class="line">    noteOn.NoteOnOff.byNote = byNote;</div>
<div class="line">    noteOn.NoteOnOff.byVelocity = 72; <span class="comment">// random velocity</span></div>
<div class="line">    noteOn.uOffset = uOnSamples;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Note-off</span></div>
<div class="line">    <a class="code" href="struct_ak_m_i_d_i_post.html">AkMIDIPost</a>&amp; noteOff = aPosts[1];</div>
<div class="line">    noteOff.byType = AK_MIDI_EVENT_TYPE_NOTE_OFF;</div>
<div class="line">    noteOff.byChan = byChan;</div>
<div class="line">    noteOff.NoteOnOff.byNote = byNote;</div>
<div class="line">    noteOff.NoteOnOff.byVelocity = 0; <span class="comment">// not used for note-off</span></div>
<div class="line">    noteOff.uOffset = uOffSamples;</div>
<div class="line"> </div>
<div class="line">    AkUniqueID eventID = AK::SoundEngine::GetIDFromString( <span class="stringliteral">&quot;MIDIEventName&quot;</span> );</div>
<div class="line">    AK::SoundEngine::PostMIDIOnEvent( eventID, REGISTERED_MIDI_GAME_OBJECT, aPosts, 2 );</div>
<div class="line">}</div>
</div><!-- fragment --><p>Refer to <a class="el" href="soundengine_events.html">Integration Details - Events</a> for more information regarding events. Refer to <a class="el" href="soundengine_midi.html">Integration Details - MIDI</a> for more information regarding MIDI. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<div class="ttc" id="astruct_ak_m_i_d_i_event_a78c8c7dc4351862a52e78fcdf84e1dc2_html_a78c8c7dc4351862a52e78fcdf84e1dc2"><div class="ttname">AkMIDIEvent::byType</div><div class="ttdeci">AkUInt8 byType</div><div class="ttdoc">See AK_MIDI_EVENT_TYPE_* pre-processor definitions.</div><div class="ttdef"><b>Definition:</b> AkMidiTypes.h:179</div></div>
<div class="ttc" id="a_ak_midi_types_8h_ab12db90c72e49a3514ad0e77b296fa5e_html_ab12db90c72e49a3514ad0e77b296fa5e"><div class="ttname">AK_MIDI_EVENT_TYPE_NOTE_ON</div><div class="ttdeci">#define AK_MIDI_EVENT_TYPE_NOTE_ON</div><div class="ttdef"><b>Definition:</b> AkMidiTypes.h:56</div></div>
<div class="ttc" id="astruct_ak_m_i_d_i_event_1_1t_note_on_off_a8b2895f66beec1aa69d5ba5c77bba9b5_html_a8b2895f66beec1aa69d5ba5c77bba9b5"><div class="ttname">AkMIDIEvent::tNoteOnOff::byNote</div><div class="ttdeci">AkMidiNoteNo byNote</div><div class="ttdef"><b>Definition:</b> AkMidiTypes.h:189</div></div>
<div class="ttc" id="astruct_ak_m_i_d_i_event_a52b225e8dcec974e4953f1eae8bd2708_html_a52b225e8dcec974e4953f1eae8bd2708"><div class="ttname">AkMIDIEvent::byChan</div><div class="ttdeci">AkMidiChannelNo byChan</div><div class="ttdef"><b>Definition:</b> AkMidiTypes.h:180</div></div>
<div class="ttc" id="anamespace_a_k_1_1_sound_engine_ade293d3ed101fe494ead6dffb1c682fb_html_ade293d3ed101fe494ead6dffb1c682fb"><div class="ttname">AK::SoundEngine::RegisterGlobalCallback</div><div class="ttdeci">AKSOUNDENGINE_API AKRESULT RegisterGlobalCallback(AkGlobalCallbackFunc in_pCallback, AkUInt32 in_eLocation=AkGlobalCallbackLocation_BeginRender, void *in_pCookie=NULL, AkPluginType in_eType=AkPluginTypeNone, AkUInt32 in_ulCompanyID=0, AkUInt32 in_ulPluginID=0)</div></div>
<div class="ttc" id="a_ak_numeral_types_8h_a6a754f6e0ddd97ae59f3aae854cde270_html_a6a754f6e0ddd97ae59f3aae854cde270"><div class="ttname">AkUInt8</div><div class="ttdeci">uint8_t AkUInt8</div><div class="ttdoc">Unsigned 8-bit integer.</div><div class="ttdef"><b>Definition:</b> AkNumeralTypes.h:36</div></div>
<div class="ttc" id="astruct_ak_m_i_d_i_event_aa85dff237546a5c178a0944ac4461a83_html_aa85dff237546a5c178a0944ac4461a83"><div class="ttname">AkMIDIEvent::NoteOnOff</div><div class="ttdeci">tNoteOnOff NoteOnOff</div><div class="ttdef"><b>Definition:</b> AkMidiTypes.h:225</div></div>
<div class="ttc" id="astruct_ak_m_i_d_i_event_1_1t_note_on_off_a7f1e76c9a11af9521550f131f7b22855_html_a7f1e76c9a11af9521550f131f7b22855"><div class="ttname">AkMIDIEvent::tNoteOnOff::byVelocity</div><div class="ttdeci">AkUInt8 byVelocity</div><div class="ttdef"><b>Definition:</b> AkMidiTypes.h:190</div></div>
<div class="ttc" id="a_common_2_ak_types_8h_a8341fa4d01d2fa852c3cc410401b04dc_html_a8341fa4d01d2fa852c3cc410401b04dc"><div class="ttname">AkUniqueID</div><div class="ttdeci">AkUInt32 AkUniqueID</div><div class="ttdoc">Unique 32-bit ID.</div><div class="ttdef"><b>Definition:</b> AkTypes.h:134</div></div>
<div class="ttc" id="astruct_ak_audio_settings_html"><div class="ttname"><a href="struct_ak_audio_settings.html">AkAudioSettings</a></div><div class="ttdoc">Configured audio settings.</div><div class="ttdef"><b>Definition:</b> AkTypes.h:304</div></div>
<div class="ttc" id="anamespace_a_k_1_1_sound_engine_ab24b5dc8bd4d1adbdc6aa5c98d94d946_html_ab24b5dc8bd4d1adbdc6aa5c98d94d946"><div class="ttname">AK::SoundEngine::PostMIDIOnEvent</div><div class="ttdeci">AKSOUNDENGINE_API AkPlayingID PostMIDIOnEvent(AkUniqueID in_eventID, AkGameObjectID in_gameObjectID, AkMIDIPost *in_pPosts, AkUInt16 in_uNumPosts, bool in_bAbsoluteOffsets=false, AkUInt32 in_uFlags=0, AkCallbackFunc in_pfnCallback=NULL, void *in_pCookie=NULL, AkPlayingID in_playingID=AK_INVALID_PLAYING_ID)</div></div>
<div class="ttc" id="anamespace_a_k_1_1_sound_engine_a1ecadb91731d6cabe36603fa419b6715_html_a1ecadb91731d6cabe36603fa419b6715"><div class="ttname">AK::SoundEngine::GetAudioSettings</div><div class="ttdeci">AKSOUNDENGINE_API AKRESULT GetAudioSettings(AkAudioSettings &amp;out_audioSettings)</div></div>
<div class="ttc" id="a_ak_callback_8h_ae7a5e30e1402c7cf90d1b47420911676_html_ae7a5e30e1402c7cf90d1b47420911676a75a5fe904855d596a5652cca9025ee41"><div class="ttname">AkGlobalCallbackLocation_PreProcessMessageQueueForRender</div><div class="ttdeci">@ AkGlobalCallbackLocation_PreProcessMessageQueueForRender</div><div class="ttdoc">Start of frame rendering, before having processed game messages.</div><div class="ttdef"><b>Definition:</b> AkCallback.h:340</div></div>
<div class="ttc" id="astruct_ak_audio_settings_a2f27fe7b83e9c83ff7fc16b3160b669f_html_a2f27fe7b83e9c83ff7fc16b3160b669f"><div class="ttname">AkAudioSettings::uNumSamplesPerFrame</div><div class="ttdeci">AkUInt32 uNumSamplesPerFrame</div><div class="ttdoc">Number of samples per audio frame (256, 512, 1024 or 2048).</div><div class="ttdef"><b>Definition:</b> AkTypes.h:305</div></div>
<div class="ttc" id="anamespace_a_k_1_1_sound_engine_a1aae6ebdec25946fb2897ce0e025366d_html_a1aae6ebdec25946fb2897ce0e025366d"><div class="ttname">AK::SoundEngine::GetIDFromString</div><div class="ttdeci">AKSOUNDENGINE_API AkUInt32 GetIDFromString(const char *in_pszString)</div></div>
<div class="ttc" id="a_ak_numeral_types_8h_a39c6c5d577901802ca77775760b704ce_html_a39c6c5d577901802ca77775760b704ce"><div class="ttname">AkUInt32</div><div class="ttdeci">uint32_t AkUInt32</div><div class="ttdoc">Unsigned 32-bit integer.</div><div class="ttdef"><b>Definition:</b> AkNumeralTypes.h:38</div></div>
<div class="ttc" id="astruct_ak_m_i_d_i_post_html"><div class="ttname"><a href="struct_ak_m_i_d_i_post.html">AkMIDIPost</a></div><div class="ttdef"><b>Definition:</b> AkMidiTypes.h:237</div></div>
<div class="ttc" id="a_ak_midi_types_8h_a4e80b2ac02932beebf56df69d409b072_html_a4e80b2ac02932beebf56df69d409b072"><div class="ttname">AK_MIDI_EVENT_TYPE_NOTE_OFF</div><div class="ttdeci">#define AK_MIDI_EVENT_TYPE_NOTE_OFF</div><div class="ttdef"><b>Definition:</b> AkMidiTypes.h:55</div></div>
<div class="ttc" id="astruct_ak_m_i_d_i_post_a946b9b31a3345afd96983129151751e9_html_a946b9b31a3345afd96983129151751e9"><div class="ttname">AkMIDIPost::uOffset</div><div class="ttdeci">AkUInt64 uOffset</div><div class="ttdoc">Frame offset (in samples) for MIDI event post.</div><div class="ttdef"><b>Definition:</b> AkMidiTypes.h:238</div></div>
</body>
</html>


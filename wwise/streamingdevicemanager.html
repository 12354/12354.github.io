<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.20"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Streaming / Stream Manager</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="akdoxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Wwise SDK 2023.1.0 - Windows
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.20 -->
</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Streaming / Stream Manager </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="streamingdevicemanager_intro"></a>
Introduction</h1>
<p>Limited bandwidth often makes access to storage devices a bottleneck in games. Therefore, to keep data transfer requests orderly, game titles usually centralize access to I/O. This order is based on relative priority and consumer requirements relative to transfer size, throughput and latency. Audio is typically I/O intensive: music and long sounds are usually streamed from disk as they are played back.</p>
<h1><a class="anchor" id="streamingdevicemanager_solution"></a>
Audiokinetic's I/O Streaming Solution</h1>
<p>Audiokinetic Sound Engine's I/O streaming solution consists of an autonomous, overridable streaming management module. The following figure is a block diagram representing the module and its place in the sound engine / game architecture:</p>
<div class="image">
<img src="Streaming_WithCustomLowLevelIO.gif" alt=""/>
</div>
<p>Its public interface, defined in <a class="el" href="_i_ak_stream_mgr_8h.html">IAkStreamMgr.h</a>, is intended to be used by both the sound engine and the game. The former uses the interface to load SoundBanks and stream audio files. The latter may use it to load graphics, textures, levels, saved games, and so on.</p>
<p>The public interface is a platform-independent high-level abstraction for data transfers involving storage (I/O) devices that wraps handles to files or other objects close to the platform's operating system or hardware into so-called "streams". In this documentation, the module that implements the stream objects and stream factory is referred to as the High-Level Stream Manager, or simply the Stream Manager.</p>
<p>You may override the Stream Manager entirely if you wish, but the Wwise SDK comes with a default implementation. This default implementation defines another level for you to hook your I/O-related code, called the Low-Level I/O, which is much simpler to use. It is the preferred way of integrating Wwise I/O into your game.</p>
<table border="1" cellspacing="0" cellpadding="5" bgcolor="#a4ecc9">
<tr>
<td><p class="starttd"><b>Default Streaming Manager Information</b><br  />
<br  />
 </p><table border="0" cellspacing="0" cellpadding="2">
<tr>
<td valign="top"><img src="images/Note.gif" alt="" class="inline"/></td><td><b>Note:</b> Throughout this chapter, you will encounter boxes like this that give additional details specific to Audiokinetic's implementation of the Stream Manager. </td></tr>
</table>
<p class="endtd">Functions and structures related to streaming but that are specific to the default implementation of the Stream Manager, such as AK::StreamMgr::Create(), are defined in <a class="el" href="_ak_stream_mgr_module_8h.html">AkStreamMgrModule.h</a>, in the SDK's include directory. </p>
</td></tr>
</table>
<h1><a class="anchor" id="streamingdevicemanager_integratingwwiseio"></a>
Integrating Wwise I/O</h1>
<h2><a class="anchor" id="streamingdevicemanager_integratingwwiseio_basic"></a>
Quick Integration</h2>
<p>To get things up and running quickly when you first integrate Wwise, use the default Stream Manager and the low-level I/O samples that ship with the Wwise SDK:</p>
<p>1) Link with AkStreamMgr.lib.</p>
<p>2) Include the default File Location Resolver and I/O Hook into your game's project:</p><ul>
<li>SDK/Samples/SoundEngine/{Platform name}/AkDefaultIOHookDeferred.h and .cpp</li>
<li>SDK/Samples/SoundEngine/{Platform name}/AkFileHelpers.h</li>
<li>All the files in SDK/Samples/SoundEngine/Common/</li>
</ul>
<p>3) After creating the Stream Manager, instantiate and initialize the low-level I/O hook device <b>CAkDefaultIOHookDeferred</b>. Note that you may use <b>CAkFilePackageLowLevelIODeferred</b> instead, which implements the File Package extension of the I/O hook (see next section). It will be ready if you eventually need it. Refer to Initializing the Streaming Manager for an example of how to initialize it.</p>
<p>4) The default file location resolver (implemented in <b>CAkFileLocationBase</b>) needs to be told the directory where files generated by the Wwise authoring tool are located. In your code, set the base path where audio assets are deployed, using <b>CAkDefaultIOHookDeferred::SetBasePath()</b> (or <b>CAkDefaultIOHookDeferred::AddBasePath()</b> ). If you have localized assets, set the current language on the default Stream Manager module using AK::StreamMgr::SetCurrentLanguage(). The default file location resolver concatenates the language name to the base path to find localized assets.</p>
<table border="0" cellspacing="0" cellpadding="2">
<tr>
<td valign="top"><img src="images/Warning.gif" alt="" class="inline"/></td><td><b>Warning:</b> Do not append a directory separator (slash or backslash) to the language name that you pass to AK::StreamMgr::SetCurrentLanguage(). </td></tr>
</table>
<p>The sound engine is now ready to load soundbanks and play streamed files from the directory you specified in <b>SetBasePath()</b>(or <b>AddBasePath()</b> ). Note that in order to automatically copy stream files in the soundbanks output directory in the Wwise tool, you should use the "CopyStreamedFiles" executable as a post-soundbank-generation step. Refer to the SoundBank Settings of the Wwise Help for more details.</p>
<h2><a class="anchor" id="streamingdevicemanager_integratingwwiseio_filepackages"></a>
File Packages</h2>
<p>If you instantiated the <b>CAkFilePackageLowLevelIODeferred</b> device, you are a few steps away from being ready to also use file packages. A file package (*.PCK) is a single file resulting from the concatenation of all soundbanks and streaming audio files from a Wwise project. You may also assign soundbanks and streaming files to different file packages. Refer to the File Packager utility documentation for more details.</p>
<p>1) Have the Wwise tool automatically generate a file package with your soundbanks and streaming files after soundbank generation, using the "FilePackager" executable as a post-soundbank-generation step (see the SoundBank Settings section of the Wwise Help).</p>
<p>2) In your code, load the file package(s) explicitly using <b>CAkFilePackageLowLevelIODeferred::LoadFilePackage()</b>. <b>LoadFilePackage()</b> opens the file package from the path you specified in <b>SetBasePath()</b>(or <b>AddBasePath()</b> ). In the deployement directory of audio assets, you need to include your file packages, but not the soundbanks and streamed files that they contain. When you load a file package, its header is parsed and a look-up table is created inside <b>CAkFilePackageLowLevelIODeferred</b>. When the sound engine tries to open a file, following a call to AK::SoundEngine::LoadBank() or an event involving playback of a streamed file, <b>CAkFilePackageLowLevelIODeferred</b> searches for it in the look-up tables of all its loaded file packages. If it is not found, the file is searched in the base path.</p>
<h2><a class="anchor" id="streamingdevicemanager_integratingwwiseio_goingfurther_routing"></a>
Routing I/O Reads to Your Own I/O Manager</h2>
<p><b>CAkDefaultIOHookDeferred</b> reads files using the platform file system API. If your game engine already has an I/O manager, you might want to route the I/O read request issued from the Wwise Stream Manager to your I/O manager instead. Edit <b>CAkDefaultIOHookDeferred::Read()</b> to call your I/O manager instead of the platform file system. If necessary, you can also edit <b>CAkDefaultIOHookDeferred::Open()</b>.</p>
<h2><a class="anchor" id="streamingdevicemanager_integratingwwiseio_goingfurther_lowlevelio"></a>
Going Further: Working with the Low-Level I/O</h2>
<p>The default Stream Manager implementation provided in the SDK sits over a submodule called the Low-Level I/O. The classes described above are all provided in the Wwise SDK as sample implementations of the Low-Level I/O. Their associated files are listed here: Default Low-Level I/O Implementation.</p>
<p>The preferred way of integrating Wwise I/O into your game engine is to let you implement a Low-Level I/O layer as an adapter between Wwise I/O and your I/O management technology. Typical implementations of the Low-Level I/O in games range from very simple to very complex and highly customized. You may use the samples as a starting point.</p>
<p>The Low-Level I/O module has 2 purposes:</p><ul>
<li>Resolves files location on disk: Files generated by Wwise can be placed anywhere on the game disk, but code must be written to ensure proper mapping between SoundBank and streaming file names and IDs to file descriptors used by the platform's file system.</li>
<li>Abstracts all low-level I/O operations: All I/O transfer requests (open/read/write) scheduled by the Stream Manager are delivered there.</li>
</ul>
<h1><a class="anchor" id="streamingdevicemanager_performance"></a>
Wwise I/O Performance</h1>
<p>The initialization settings of the Stream Manager have an impact on how it interacts with your Low-Level I/O system, and on overall I/O performance. They are described thoroughly in chapter <a class="el" href="streamingmanager_settings.html">Audiokinetic Stream Manager Initialization Settings</a>. Chapter <a class="el" href="streamingmanager_tips.html">I/O Tips, Troubleshooting and Optimization</a> may help you tweak them.</p>
<h1><a class="anchor" id="streamingdevicemanager_highlevel"></a>
High-Level Stream Manager</h1>
<p>The Stream Manager, whose interface is defined in <a class="el" href="_i_ak_stream_mgr_8h.html">IAkStreamMgr.h</a>, is used by the Wwise sound engine to read soundbanks and streamed audio files. You are also welcome to use it for all your game I/O if you don't already have an I/O manager. Likewise, if you write a custom source plug-in, you may access the Stream Manager.</p>
<p>Section <a class="el" href="streamingmanager_highlevel.html">High-Level Stream Manager API Description</a> explains its API in details. You may skip this chapter if you don't use it directly as a client, and only integrate Wwise I/O into your game by implementing the low-level I/O hooks.</p>
<p>Here are just a few basic concepts. The Stream Manager manages abstract streams of data of two different types: standard streams and automatic streams.</p>
<ul>
<li><b>Standard streams</b> (<a class="el" href="class_a_k_1_1_i_ak_std_stream.html">AK::IAkStdStream</a>): These post I/O requests to the Stream Manager on demand when a call to AK::IAkStdStream::Read() or AK::IAkStdStream::Write() is issued. I/O is performed in user-specified memory.</li>
<li><b>Automatic streams</b> (<a class="el" href="class_a_k_1_1_i_ak_auto_stream.html">AK::IAkAutoStream</a>): Automatic streams access data with the AK::IAkAutoStream::GetBuffer() / AK::IAkAutoStream::ReleaseBuffer() methods, by granting addresses from the internal streaming memory. The main interface, <a class="el" href="class_a_k_1_1_i_ak_stream_mgr.html">AK::IAkStreamMgr</a>, acts as a stream factory. Automatic streams manage memory internally, and I/O requests are posted to the Low-Level IO automatically when that memory is free for writing.</li>
</ul>
<p>The Stream Manager is intended to be thread-safe, but only one thread may own a given stream.</p>
<p>The main interface <a class="el" href="class_a_k_1_1_i_ak_stream_mgr.html">AK::IAkStreamMgr</a> is accessible from anywhere by calling AK::IAkStreamMgr::Get(). From there, you may create and use stream objects.</p>
<h1><a class="anchor" id="streamingdevicemanager_more"></a>
Further Information</h1>
<p>The following sections provide more detailed information about streaming:</p>
<ul>
<li><a class="el" href="streamingmanager_lowlevel.html">Low-Level I/O</a></li>
<li><a class="el" href="streamingmanager_settings.html">Audiokinetic Stream Manager Initialization Settings</a></li>
<li><a class="el" href="streamingmanager_tips.html">I/O Tips, Troubleshooting and Optimization</a></li>
<li><a class="el" href="streamingmanager_highlevel.html">High-Level Stream Manager API Description</a> </li>
</ul>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</body>
</html>


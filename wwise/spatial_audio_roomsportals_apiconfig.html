<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.20"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Rooms and Portals API Configuration</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="akdoxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Wwise SDK 2023.1.0 - Windows
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.20 -->
</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Rooms and Portals API Configuration </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="spatial_audio_roomsportals_apiconfigcreateroom"></a>
Creating Rooms and Portals</h1>
<p>You need to create Rooms and Portals based on the geometry of your map or level, with <code>AK::SpatialAudio::SetRoom</code> and <code>AK::SpatialAudio::SetPortal</code>. Rooms and Portals have settings that you may change at run-time by calling these functions again with the same ID. Then the game calls <code>AK::SpatialAudio::SetGameObjectInRoom</code> for each emitter and the listener to tell Spatial Audio in what room they are. From the point of view of Spatial Audio, Rooms don't have a defined position, shape, or size. They can thus be of any shape, but it is the responsibility of the game engine to perform containment tests to determine in which Room the objects are.</p>
<table border="0" cellspacing="0" cellpadding="2">
<tr>
<td valign="top"><img src="images/Warning.gif" alt="" class="inline"/></td><td><b>Warning:</b> Beware of Room IDs. They share the same scope as game objects, so make sure that you never use an ID that is already used as a game object. </td></tr>
</table>
<table border="0" cellspacing="0" cellpadding="2">
<tr>
<td valign="top"><img src="images/Warning.gif" alt="" class="inline"/></td><td><b>Warning:</b> Under the hood, Spatial Audio registers a game object to Wwise for each Room. The user can post events on this game object for ambience/room tone sounds, but should not attempt to alter the position or game-defined sends of the object in calls to <code><a class="el" href="namespace_a_k_1_1_sound_engine.html">AK::SoundEngine</a></code>. </td></tr>
</table>
<p>The most important Room setting is <code>AkRoomParams::ReverbAuxBus</code>, which tells Spatial Audio to which auxiliary bus emitters should send when they are in that Room. Other settings will be discussed in sections below (see Setting Up a Room Auxiliary Bus in Wwise and Transmission).</p>
<p>Portals represent openings between two Rooms. Contrary to Rooms, Portals have position and size, so Spatial Audio can perform containment tests itself. Portal size is given by the Portal setting <code>AkPortalParams::Extent</code>. Width and height (X and Y) are used by Spatial Audio to compute diffraction and spread, while depth (Z) defines a region in which Spatial Audio performs a smooth transition between the two connected Rooms by carefully manipulating the auxiliary send levels, Room object placement, and Spread (used by 3D Spatialization). Refer to sections Setting Up a Room Auxiliary Bus in Wwise and Summary of Sound Propagation Features below for more details. Additionally, Portals may be enabled (open) or disabled (closed) using the <code>AkPortalParams::bEnabled</code> Portal setting.</p>
<h1><a class="anchor" id="spatial_audio_roomsportals_apiconfigroomtones"></a>
Posting Events on Room Game Objects</h1>
<p>It is possible to post an event on a Room Game object to take advantage of their spatialization behavior. Simply call AK::SoundEngine::PostEvent, passing the room ID as the AkGameObjectID. The room ID can be safely cast to a AkGameObjectID by calling AkRoomID::AsGameObjectID. If a room is to be used for posting events, then Spatial Audio must be told not to unregister the Room Game Object when it is not in use. To do so, make sure to set AkRoomParams::RoomGameObj_KeepRegistered to true.</p>
<p>Additionally, when using room tones, it may be useful to have the Game Object send to its own Room Auxiliary Bus. To do so, pass a value greater than zero to AkRoomParams::RoomGameObj_AuxSendLevelToSelf.</p>
<h1><a class="anchor" id="spatial_audio_roomsportals_apiconfigroomgeometry"></a>
Setting up Room Geometry</h1>
<p>Associating a Geometry Instance with a Room serves the following purposes:</p><ul>
<li>It enables calculation of the Room's bounding box, which in turn is used to calculate the position and spread of the Room's transmission path.</li>
<li>It allows Spatial Audio to determine which Game Objects are in which Room. Alternatively, clients can use <code>AK::SpatialAudio::SetGameObjectInRoom</code> for this purpose, if desired.</li>
<li>It enables accurate specification of transmission loss values, according to the transmission loss coefficient of each individual surface.</li>
<li>It enables the display of the room inside the Game Object 3D Viewer.</li>
<li>Optionally, it enables reflection and diffraction simulation using the walls of a room, if <code>AkGeometryInstanceParams::UseForReflectionAndDiffraction</code> is set to true.</li>
</ul>
<p>Setting up Room geometry is optional but recommended. Without Room geometry, the Room will not be visible in the Game Object 3D viewer, and Spatial Audio will estimate the extent of the Room (for Room transmission) by calculating a bounding box that encompasses all attached portals. For more information about Room transmission refer to Transmission of Room Tones and a Room's Diffuse Field.</p>
<p>Spatial Audio performs containment tests using Room geometry to determine which Room each Game Object is in. If a specific type of containment test is desired, this task can instead by performed by the client, using <code>AK::SpatialAudio::SetGameObjectInRoom</code>. However, geometry is mandatory for Rooms that are designated as Reverb Zones, so that Spatial Audio can determine whether a Game Object is inside the transition region of a the Reverb Zone. Refer to spatial_audio_roomsportals_reverbzones_transition_regions.</p>
<p>To associate geometry with a Room, first, pass the geometry to Wwise using AK::SpatialAudio::SetGeometry. It is then necessary to create a Geometry Instance to assign a position, scale and rotation to the geometry. Refer to AK::SpatialAudio::SetGeometryInstance. Lastly, populate the AkRoomParams::GeometryInstanceID field when calling AK::SpatialAudio::SetRoom, with the ID of the Geometry Instance representing the room. Spatial Audio assumes that there was, or will be, a corresponding call to AK::SpatialAudio::SetGeometryInstance, however, it does not matter in which order AK::SpatialAudio::SetRoom and AK::SpatialAudio::SetGeometryInstance are called.</p>
<table border="0" cellspacing="0" cellpadding="2">
<tr>
<td valign="top"><img src="images/Note.gif" alt="" class="inline"/></td><td><b>Note:</b> If a geometry instance is to be used only by a Room, for purposes listed above, and not for reflection and diffraction calculation, then set AkGeometryInstanceParams::UseForReflectionAndDiffraction to false. </td></tr>
</table>
<p>For information about how to define geometry in Spatial Audio, refer to <a class="el" href="spatial_audio_apigeometry.html">Geometry</a>.</p>
<table border="0" cellspacing="0" cellpadding="2">
<tr>
<td valign="top"><img src="images/Note.gif" alt="" class="inline"/></td><td><b>Note:</b> If a geometry set is only to be used for describing a Room and not for reflection and diffraction calculation, then make sure to set <code>AkGeometryParams::EnableTriangles</code> to false. </td></tr>
</table>
<table border="0" cellspacing="0" cellpadding="2">
<tr>
<td valign="top"><img src="images/Warning.gif" alt="" class="inline"/></td><td><b>Warning:</b> AkRoomParams::GeometryInstanceID should not be confused with AkGeometryInstanceParams::RoomID. AkRoomParams::GeometryInstanceID is used as described above to define a room bounding box for transmission spread calculation and for visualization in the Game Object 3D Viewer. AkGeometryInstanceParams::RoomID is used solely as an optimization to limit the scope in which the geometry is visible/accessible, when performing ray traces inside of Spatial Audio. </td></tr>
</table>
<h1><a class="anchor" id="spatial_audio_roomsportals_apiconfigsetmultiplepositions"></a>
Sound Emitters with Multiple Positions</h1>
<p>When using <code>AK::SoundEngine::SetMultiplePositions</code>, Spatial Audio performs various calculations including reflections, diffraction and transmission for each sound position passed to the API.</p>
<p>There are a few important points to note when using <code>AK::SoundEngine::SetMultiplePositions</code> on game objects that use room sends, because a given game object can only be assigned to a single room at a given time (using <code>AK::SpatialAudio::SetGameObjectInRoom</code>). This limitation arises from the constraint that all sound positions must have the same Auxiliary send configuration inside the Sound Engine.</p>
<p>All sound paths that are calculated from an emitter's position are done so with respect to the (single) requested room. For this reason, in the case that a sound position is outside the (game-defined) boundary of the room set via <code>AK::SpatialAudio::SetGameObjectInRoom</code>, the resulting sound path will most likely be erroneous.</p>
<p>In addition, if the game object is transitioning through a portal, Spatial Audio takes the average of all sound positions passed to <code>AK::SoundEngine::SetMultiplePositions</code> and uses it to calculate a cross-fade between the two rooms.</p>
<p>For this reason, it is recommended that the game also use the average sound position to derive room containment and pass the resulting room ID to <code>AK::SpatialAudio::SetGameObjectInRoom</code>.</p>
<h1><a class="anchor" id="spatial_audio_roomsportals_apiconfigexample"></a>
Example Rooms and Portals Integration</h1>
<p>The Integration Demo sample (in <em>SDK/samples/IntegrationDemo</em>) has a demo page which shows how to use the API. Look for Demo Positioning &gt; Spatial Audio: Portals. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</body>
</html>


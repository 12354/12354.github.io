<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.20"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Integration Details - 3D Positions</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="akdoxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Wwise SDK 2023.1.0 - Windows
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.20 -->
</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Integration Details - 3D Positions </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>Sounds are played in Wwise by posting Events to objects that the game registers and optionally assigns a position. These game objects thus become <em>emitters</em>. The relative position of the simulated 3D environment <em>emitters</em> and <em>listeners</em> may be used to drive panning and other properties of sounds, which helps the auditive and visual experiences immerse the player in a credible 3D environment.</p>
<p>In Wwise, the designer may choose to pan a sound on the player's speaker setup manually (Speaker Panning), or based on game object position (3D Spatialization). Additionally, it may assign a set of attenuation curves and settings which modify the sound properties (volume, filtering, and so on) based on distance or angle.</p>
<h1><a class="anchor" id="soundengine_3dpositions_realworld"></a>
Setting a Game Object's Position</h1>
<p>Call the <code><a class="el" href="namespace_a_k_1_1_sound_engine_a789e25bda32d1e11849afb6584942455.html#a789e25bda32d1e11849afb6584942455">AK::SoundEngine::SetPosition()</a></code> function for every game object whose sounds require this information. Also, make sure to call it for the listener game object. You need to set the position every time the position of a game object changes.</p>
<div class="fragment"><div class="line"><a class="code" href="_common_2_ak_types_8h_a64f7d1f79613cc4dcc49a4efba6caa63.html#a64f7d1f79613cc4dcc49a4efba6caa63">AKRESULT</a> <a class="code" href="namespace_a_k_1_1_sound_engine_a789e25bda32d1e11849afb6584942455.html#a789e25bda32d1e11849afb6584942455">AK::SoundEngine::SetPosition</a>( </div>
<div class="line">    <a class="code" href="_common_2_ak_types_8h_a352a1eb6955fa208062e40a9ccdd2560.html#a352a1eb6955fa208062e40a9ccdd2560">AkGameObjectID</a> in_GameObjectID,                             <span class="comment">// Game object identifier</span></div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="class_ak_world_transform.html">AkSoundPosition</a> &amp; in_Position                         <span class="comment">// Position to set</span></div>
<div class="line">);</div>
</div><!-- fragment --><p>The first parameter is the ID of the game object. Refer to <a class="el" href="soundengine_gameobj.html">Integration Details - Game Objects</a> for more information.</p>
<p>The second parameter is an <code><a class="el" href="class_ak_transform.html" title="Position and orientation of objects in a &quot;local&quot; space.">AkTransform</a></code> structure that contains vectors representing the position and orientation of the game object. Refer to <a class="el" href="soundengine_3dpositions.html#soundengine_3dpositions_xyz">X-Y-Z Coordinate System</a> for information regarding how the X, Y, and Z axes are defined in the Wwise sound engine.</p>
<table border="0" cellspacing="0" cellpadding="2">
<tr>
<td valign="top"><img src="images/Note.gif" alt="" class="inline"/></td><td><b>Note:</b> If you call the <code><a class="el" href="namespace_a_k_1_1_sound_engine_a789e25bda32d1e11849afb6584942455.html#a789e25bda32d1e11849afb6584942455">AK::SoundEngine::SetPosition()</a></code> function multiple times and then call the <code><a class="el" href="namespace_a_k_1_1_sound_engine_afe54af0f5be38be061e8a3c7d7642bb1.html#afe54af0f5be38be061e8a3c7d7642bb1">AK::SoundEngine::RenderAudio()</a></code> function, only the last value will be considered. </td></tr>
</table>
<h2><a class="anchor" id="soundengine_3dpositions_followsetlistenerpos"></a>
Following the listener position</h2>
<p>In order to mimic a behavior where the emitter position could automatically stick to the listener position, you need to explicitly set the game object's position to the same value as the listener position at every frame. You can also post Events on the listener game object.</p>
<h2><a class="anchor" id="soundengine_3dpositions_multiplepos"></a>
Setting multiple positions for a single game object</h2>
<p>Instead of using the <code><a class="el" href="namespace_a_k_1_1_sound_engine_a789e25bda32d1e11849afb6584942455.html#a789e25bda32d1e11849afb6584942455">AK::SoundEngine::SetPosition()</a></code> function, which only allows a single 3D position for each game object, you can use the <code><a class="el" href="namespace_a_k_1_1_sound_engine_a79fc25a0656b560e0e601a558be26e31.html#a79fc25a0656b560e0e601a558be26e31">AK::SoundEngine::SetMultiplePositions()</a></code> function, which allows you to set multiple 3D positions for a single game object.</p>
<div class="fragment"><div class="line"><a class="code" href="_common_2_ak_types_8h_a64f7d1f79613cc4dcc49a4efba6caa63.html#a64f7d1f79613cc4dcc49a4efba6caa63">AKRESULT</a> <a class="code" href="namespace_a_k_1_1_sound_engine_a79fc25a0656b560e0e601a558be26e31.html#a79fc25a0656b560e0e601a558be26e31">AK::SoundEngine::SetMultiplePositions</a>( </div>
<div class="line">            <a class="code" href="_common_2_ak_types_8h_a352a1eb6955fa208062e40a9ccdd2560.html#a352a1eb6955fa208062e40a9ccdd2560">AkGameObjectID</a> in_GameObjectID,             <span class="comment">///&lt; Game object identifier.</span></div>
<div class="line"><span class="comment"></span>            <span class="keyword">const</span> <a class="code" href="class_ak_world_transform.html">AkSoundPosition</a> * in_pPositions,      <span class="comment">///&lt; Array of positions to apply.</span></div>
<div class="line"><span class="comment"></span>            <a class="code" href="_ak_numeral_types_8h_a7100a9b0a3b01df7639c1dc512678219.html#a7100a9b0a3b01df7639c1dc512678219">AkUInt16</a> in_NumPositions,                   <span class="comment">///&lt; Number of positions specified in the provided array.</span></div>
<div class="line"><span class="comment"></span>            <a class="code" href="namespace_a_k_1_1_sound_engine_a363d76a23339510f845da6bda4b95580.html#a363d76a23339510f845da6bda4b95580">MultiPositionType</a> in_eMultiPositionType     <span class="comment">///&lt; \ref AK::SoundEngine::MultiPositionType</span></div>
<div class="line"><span class="comment"></span>            );</div>
<div class="line">);</div>
</div><!-- fragment --><p>Select the <code>MultiPositionType</code> carefully. The option you choose depends on the situation and the type of effect you are trying to create.</p>
<ul>
<li>If you pass <code>MultiPositionType_MultiSources</code>, the different sound volumes are added, which simulates multiple objects emitting the same sound at the same time. This function can be useful in many different situations, and works well when you have many objects that emit the exact same sound. This function might, however, cause certain issues when the sounds are too close to each other. The problem being that by adding volumes, multiple sounds will be playing exactly in phase, which increases the chance of clipping.</li>
<li>If you pass <code>MultiPositionType_MultiDirections</code>, the volume played in each speaker is the maximum in each direction. This function can be used to simulate a variety of different situations in game, including wall openings, area sounds, as well as multiple objects emitting the same sound at the same time. If, however, the game player expects the sound to grow louder when two or more objects emitting the sound are in close proximity, add the sounds with <code>MultiPositionType_MultiSources</code>.</li>
<li>Do not use <code>MultiPositionType_SingleSource</code> with <code><a class="el" href="namespace_a_k_1_1_sound_engine_a79fc25a0656b560e0e601a558be26e31.html#a79fc25a0656b560e0e601a558be26e31">SetMultiplePositions()</a></code> because it only takes the first listed position into account.</li>
<li>Due to technical limitations, sounds that have diffraction enabled are always treated as <code>MultiPositionType_MultiDirections</code>.</li>
</ul>
<p>By creating multiple positions for a single game object, you can simulate a number of different sound effects, including:</p><ul>
<li><a class="el" href="soundengine_3dpositions.html#area_sounds">Area sounds</a></li>
<li><a class="el" href="soundengine_3dpositions.html#multiple_objects">Multiple objects emitting the same sound in the same area</a></li>
<li><a class="el" href="soundengine_3dpositions.html#stereo_speakers">Outputting the different channels of a single source to different positions</a></li>
<li><a class="el" href="soundengine_3dpositions.html#simulating_sounds">Simulating sounds coming from openings (Sound Relocalization)</a></li>
</ul>
<h3><a class="anchor" id="area_sounds"></a>
Area sounds</h3>
<p>You can simulate area sounds by using the <code>MultiPositionType_MultiDirections</code> option combined with appropriate values for Spread and distance-based Volume Attenuation. When using this method, you need to make sure that the number of positions does not increase the volume additively. By recreating area sounds using this method, you can have a single sound coming from multiple directions with realistic attenuation.</p>
<p>In the following example, the black dots represent the initial position of sounds, the black circles represent the minimum distance for attenuation and spreading, and the pink circles represent the maximum radius:</p>
<div class="image">
<img src="AreaSound.gif" alt=""/>
<div class="caption">
Figure: Sample of Area Sound with Multiple Positions</div></div>
<p>The blue region represents a lake in your game. The ambience sounds emanating from the lake are simulated using a sound with four positions.</p>
<p>When the listener is at position A, the sound of the lake should come from all directions. This can be achieved by setting an appropriately high spread value, which diffuses the sounds so that they play back in all speakers.</p>
<p>When the listener is at position B, they are beyond the maximum attenuation distance. This means that they will either hear no lake sounds or they will hear only a faint sound at its maximum attenuation. Because you are using multiple positions to simulate a large lake, the sound will always comes from the appropriate direction.</p>
<p>When the listener is at position C, they will hear the lake from a wide angle of speakers (~180 degrees), but the sounds will be attenuated because the listener is a certain distance away from the lake. In this situation, the listener is still within the attenuation radius, so the lake sounds will not be attenuated to their maximum levels.</p>
<p>By using this technique, you can recreate any kind of object shape by overlapping multiple sound positions. Keep in mind, however, that with each new position added, more CPU is required to calculate the resulting volumes.</p>
<h3><a class="anchor" id="multiple_objects"></a>
Multiple objects emitting the same sound in the same area</h3>
<p>Let's say, for example, that in one of your levels, the corridors are all lit by a series of torches on the walls. These torches are all the same and will play the exact same sound. If you post a Play Event for each of them separately (supposing there are 20 of them), it would consume significantly more CPU and memory. Also, if the sound is being streamed, you may potentially have multiple duplicated streams, which can increase I/O access.</p>
<p>In this situation, using <code><a class="el" href="namespace_a_k_1_1_sound_engine_a79fc25a0656b560e0e601a558be26e31.html#a79fc25a0656b560e0e601a558be26e31">SetMultiplePositions()</a></code> would greatly improve performance. It also allows you to easily control all sounds in one operation, and reduces the number of game objects that need to be registered.</p>
<p>When creating this scenario in game, you can use either <code>MultiPositionType_MultiSources</code> or <code>MultiPositionType_MultiDirections</code>.</p>
<p><code>MultiPositionType_MultiSources</code> will usually be more accurate, but may be problematic if positions are too close to one another. Remember that when only one voice is played to simulate multiple sounds, Wwise adds the volumes of the different positions, which may result in the volume going over 0 dB. <code>MultiPositionType_MultiDirections</code> uses a bit less CPU, and simply takes the maximum volume and plays it through each speaker. Since <code>MultiPositionType_MultiDirections</code> does not add the volumes, it guarantees that there will be no clipping and, therefore, may be more suitable.</p>
<p>Despite there being multiple positions for a sound, there is still only one voice played by the sound engine. This means that when all sounds are out of range, only one virtual voice will be processed.</p>
<h3><a class="anchor" id="stereo_speakers"></a>
Outputting the different channels of a single source to different positions</h3>
<p>Let's say a car is blasting stereo-recorded music from its speakers—the emitters. As seen in the image below, the left and right emitters could output respectively the left and right input channels of the music's stereo source file.</p>
<p>In this situation, using the <code><a class="el" href="namespace_a_k_1_1_sound_engine_a79fc25a0656b560e0e601a558be26e31.html#a79fc25a0656b560e0e601a558be26e31">SetMultiplePositions()</a></code> overload with the <code><a class="el" href="struct_ak_channel_emitter.html" title="Positioning information for a sound, with specified subset of its channels.">AkChannelEmitter</a></code> parameter provides flexible assignment of input channels. The <code>AkChannelMask</code> specifies which input channel, the left or right, the emitter positions use. Therefore, if the audio content is different in the left and right channels of the source, the listener will hear these differences relative to its current position.</p>
<div class="image">
<img src="SingleSourceMultipleEmitters.png" alt=""/>
<div class="caption">
Figure: Showing how a single multichannel source can emit different channels at different positions</div></div>
<table border="0" cellspacing="0" cellpadding="2">
<tr>
<td valign="top"><img src="images/Note.gif" alt="" class="inline"/></td><td><b>Note:</b> The listeners to the left and the right of the car in the above image will hear a combination of the left (red) and right (blue) emitters in a single output channel, which is consequently highlighted in a shade of purple. The exact combination of the emitters depends on the attenuation distances and curves set for them. For example, a listener at a certain distance to the right of the car is likely to hear the right speaker more than the left, which would have greater attenuation. At a certain distance to the right, the listener may not even hear the left speaker at all. </td></tr>
</table>
<h3><a class="anchor" id="simulating_sounds"></a>
Simulating sounds coming from openings (Sound Relocalization)</h3>
<p>When sounds are partially obstructed and/or occluded, they may appear to come from different directions than where they are actually located. In these cases, you can position the sound in multiple locations to create the effect that you want.</p>
<p>For example, let's say that the direct path of a sound is blocked by a building—see the following illustration. Instead of using the real position of object A, it would sound more realistic to use the two alternate positions: A' and A''. When doing so, use <code><a class="el" href="namespace_a_k_1_1_sound_engine_a1b3e18a25b405e55ba82de9b70cd11ba.html#a1b3e18a25b405e55ba82de9b70cd11ba">SetObjectObstructionAndOcclusion()</a></code> and the same occlusion and obstruction parameters will apply to all positions, or use <code><a class="el" href="namespace_a_k_1_1_sound_engine_ab0216f0dc33bef431d5d92f519e5be58.html#ab0216f0dc33bef431d5d92f519e5be58">SetMultipleObstructionAndOcclusion()</a></code> and specify a unique occlusion and obstruction value for each sound position.</p>
<div class="image">
<img src="Buildings.gif" alt=""/>
<div class="caption">
Figure: Relocating a sound using two alternate positions</div></div>
<p>This approach also works well when simulating environments that have been destroyed, and sounds are coming from a number of arbitrary positions. When re-localizing sounds, it is better to use <code>MultiPositionType_MultiDirections</code>.</p>
<h1><a class="anchor" id="soundengine_3dpositions_xyz"></a>
X-Y-Z Coordinate System</h1>
<p>The Wwise sound expects a left-handed coordinate system. The default values are the following, although the only thing that matters is the position and orientation of emitters relative to the listener orientation frame:</p><ul>
<li>X: Vector that points to the right</li>
<li>Y: Vector that points up</li>
<li>Z: Vector that points forward.</li>
</ul>
<div class="image">
<img src="PositioningAxis.gif" alt=""/>
<div class="caption">
Direction of the X, Y and Z Axes in the Wwise Sound Engine.</div></div>
<p>For an example of integrating 3D positions, refer to <a class="el" href="quickstart_sample_integration_3dpos.html#soundengine_integration_positions">3D Position Example</a>.</p>
<dl class="section see"><dt>See also</dt><dd><ul>
<li>Sample code in <a class="el" href="samplecode.html#samplecode_integration">Game Integration Sample Code</a> for examples of game object positioning.</li>
<li><a class="el" href="soundengine_listeners.html">Integrating Listeners</a></li>
<li><a class="el" href="soundengine_gameobj.html">Integration Details - Game Objects</a> </li>
</ul>
</dd></dl>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<div class="ttc" id="a_ak_numeral_types_8h_a7100a9b0a3b01df7639c1dc512678219_html_a7100a9b0a3b01df7639c1dc512678219"><div class="ttname"><a href="_ak_numeral_types_8h_a7100a9b0a3b01df7639c1dc512678219.html#a7100a9b0a3b01df7639c1dc512678219">AkUInt16</a></div><div class="ttdeci">uint16_t AkUInt16</div><div class="ttdoc">Unsigned 16-bit integer.</div><div class="ttdef"><b>Definition:</b> <a href="_ak_numeral_types_8h_source.html#l00037">AkNumeralTypes.h:37</a></div></div>
<div class="ttc" id="anamespace_a_k_1_1_sound_engine_a363d76a23339510f845da6bda4b95580_html_a363d76a23339510f845da6bda4b95580"><div class="ttname"><a href="namespace_a_k_1_1_sound_engine_a363d76a23339510f845da6bda4b95580.html#a363d76a23339510f845da6bda4b95580">AK::SoundEngine::MultiPositionType</a></div><div class="ttdeci">MultiPositionType</div><div class="ttdef"><b>Definition:</b> <a href="_common_2_ak_types_8h_source.html#l01171">AkTypes.h:1172</a></div></div>
<div class="ttc" id="a_common_2_ak_types_8h_a352a1eb6955fa208062e40a9ccdd2560_html_a352a1eb6955fa208062e40a9ccdd2560"><div class="ttname"><a href="_common_2_ak_types_8h_a352a1eb6955fa208062e40a9ccdd2560.html#a352a1eb6955fa208062e40a9ccdd2560">AkGameObjectID</a></div><div class="ttdeci">AkUInt64 AkGameObjectID</div><div class="ttdoc">Game object ID.</div><div class="ttdef"><b>Definition:</b> <a href="_common_2_ak_types_8h_source.html#l00142">AkTypes.h:142</a></div></div>
<div class="ttc" id="a_common_2_ak_types_8h_a64f7d1f79613cc4dcc49a4efba6caa63_html_a64f7d1f79613cc4dcc49a4efba6caa63"><div class="ttname"><a href="_common_2_ak_types_8h_a64f7d1f79613cc4dcc49a4efba6caa63.html#a64f7d1f79613cc4dcc49a4efba6caa63">AKRESULT</a></div><div class="ttdeci">AKRESULT</div><div class="ttdoc">Standard function call result.</div><div class="ttdef"><b>Definition:</b> <a href="_common_2_ak_types_8h_source.html#l00212">AkTypes.h:213</a></div></div>
<div class="ttc" id="aclass_ak_world_transform_html"><div class="ttname"><a href="class_ak_world_transform.html">AkWorldTransform</a></div><div class="ttdoc">Position and orientation of game objects in the world (i.e. supports 64-bit-precision position)</div><div class="ttdef"><b>Definition:</b> <a href="_common_2_ak_types_8h_source.html#l00492">AkTypes.h:493</a></div></div>
<div class="ttc" id="anamespace_a_k_1_1_sound_engine_a79fc25a0656b560e0e601a558be26e31_html_a79fc25a0656b560e0e601a558be26e31"><div class="ttname"><a href="namespace_a_k_1_1_sound_engine_a79fc25a0656b560e0e601a558be26e31.html#a79fc25a0656b560e0e601a558be26e31">AK::SoundEngine::SetMultiplePositions</a></div><div class="ttdeci">AKSOUNDENGINE_API AKRESULT SetMultiplePositions(AkGameObjectID in_GameObjectID, const AkSoundPosition *in_pPositions, AkUInt16 in_NumPositions, MultiPositionType in_eMultiPositionType=MultiPositionType_MultiDirections, AkSetPositionFlags in_eFlags=AkSetPositionFlags_Default)</div></div>
<div class="ttc" id="anamespace_a_k_1_1_sound_engine_a789e25bda32d1e11849afb6584942455_html_a789e25bda32d1e11849afb6584942455"><div class="ttname"><a href="namespace_a_k_1_1_sound_engine_a789e25bda32d1e11849afb6584942455.html#a789e25bda32d1e11849afb6584942455">AK::SoundEngine::SetPosition</a></div><div class="ttdeci">AKSOUNDENGINE_API AKRESULT SetPosition(AkGameObjectID in_GameObjectID, const AkSoundPosition &amp;in_Position, AkSetPositionFlags in_eFlags=AkSetPositionFlags_Default)</div></div>
</body>
</html>

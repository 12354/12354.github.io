<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.20"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Model of an Authoring Plug-in</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="akdoxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Wwise SDK 2023.1.0 - Windows
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.20 -->
</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Model of an Authoring Plug-in </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>This page documents how the model of a plug-in can be accessed and modified. The model is composed of two elements:</p>
<ul>
<li>A standard model called a Property Set that is completely described by the XML definition of the plug-in that can be accessed with the component provided by <code>AK::Wwise::Plugin::RequestPropertySet</code>. This is limited to certain types of data, but offers automatic handling for saving, loading, undoing and redoing changes as well as binding as the model for GUI controls.</li>
<li>A custom model called the Custom Data that can optionally be added to your plug-in to represent more complex data, with the limitation that operations that are automatic for the Property Set need to be implemented explicitly. This limitation also extends to GUI controls that need to be updated manually.</li>
</ul>
<h1><a class="anchor" id="wwiseplugin_propertyset"></a>
Property Set</h1>
<p>A Property Set instance is provided to the plug-in as a member variable <code>m_propertySet</code> when deriving the <code>AK::Wwise::Plugin::RequestPropertySet</code> request interface. In functions such as <code>AK::Wwise::Plugin::AudioPlugin::GetBankParameters</code>, you can access the values for properties defined in the XML to write the values in the bank (for more information, refer to Generating SoundBanks). Accessors for the most common types are provided explicitly, but using an accessor type that does not match the type specified in the XML is undefined behavior.</p>
<p>For your convenience, <code>AK::Wwise::Plugin::RequestPropertySet</code> is automatically requested when the plug-in class is derived from <code>AK::Wwise::Plugin::AudioPlugin</code>. In other cases, such as creating a frontend, it must be requested.</p>
<div class="fragment"><div class="line"><span class="keyword">class </span>MySourcePlugin</div>
<div class="line">:   <span class="keyword">public</span> <a class="code" href="class_a_k_1_1_wwise_1_1_plugin_1_1_v1_1_1_audio_plugin.html">AK::Wwise::Plugin::AudioPlugin</a></div>
<div class="line">{</div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line">    <span class="keywordtype">bool</span> GetBankParameters(</div>
<div class="line">         <span class="keyword">const</span> <a class="code" href="struct_g_u_i_d.html">GUID</a>&amp; in_guidPlatform,</div>
<div class="line">         <a class="code" href="class_a_k_1_1_wwise_1_1_plugin_1_1_v1_1_1_data_writer.html">AK::Wwise::Plugin::DataWriter</a>&amp; in_dataWriter)<span class="keyword"> const override</span></div>
<div class="line"><span class="keyword">    </span>{</div>
<div class="line">        <span class="keywordtype">bool</span> result = <span class="keyword">true</span>;</div>
<div class="line">        <span class="comment">// Access the property set</span></div>
<div class="line">        int32_t value = m_propertySet.GetInt32(in_guidPlatform, <span class="stringliteral">&quot;PropertyKey&quot;</span>);</div>
<div class="line">        <span class="comment">// Write the value into the sound bank</span></div>
<div class="line">        result &amp;= in_dataWriter.WriteInt32(value);</div>
<div class="line">        <span class="keywordflow">return</span> result;</div>
<div class="line">    }</div>
<div class="line">};</div>
</div><!-- fragment --><table border="0" cellspacing="0" cellpadding="2">
<tr>
<td valign="top"><img src="images/Note.gif" alt="" class="inline"/></td><td><b>Note:</b> The lifetime of the <code>m_propertySet</code> variable is the same as the lifetime of the plug-in instance. Do not store this instance across plug-in instances. You can also request this service both in your backend and your frontend class. </td></tr>
</table>
<h2><a class="anchor" id="wwiseplugin_propertyset_notification"></a>
Property Value Notification</h2>
<p>Wwise users can change property values either directly through a control in the dialog, or by using the undo/redo commands. When a user changes a property value, <code>AK::Wwise::Plugin::Notifications::PropertySet::NotifyPropertyChanged()</code> is called on your plug-in. This way, it is possible for adapting the value of other properties based on this change, e.g., custom data and property range dependencies. Also, if your dialog is being displayed at that time, you can specify actions to be performed in the dialog such as enabling or disabling controls.</p>
<table border="0" cellspacing="0" cellpadding="2">
<tr>
<td valign="top"><img src="images/Note.gif" alt="" class="inline"/></td><td><b>Note:</b> The XML allows describing dependencies based on rules. See Plug-in XML Dependencies for more details. </td></tr>
</table>
<div class="fragment"><div class="line"><span class="keyword">class </span>MySourcePlugin</div>
<div class="line">:   <span class="keyword">public</span> <a class="code" href="class_a_k_1_1_wwise_1_1_plugin_1_1_v1_1_1_audio_plugin.html">AK::Wwise::Plugin::AudioPlugin</a></div>
<div class="line">{</div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line">    <span class="keywordtype">void</span> NotifyPropertyChanged(</div>
<div class="line">         <span class="keyword">const</span> <a class="code" href="struct_g_u_i_d.html">GUID</a>&amp; in_guidPlatform,</div>
<div class="line">         <span class="keyword">const</span> <span class="keywordtype">char</span>* in_szPropertyName)<span class="keyword"> override</span></div>
<div class="line"><span class="keyword">    </span>{</div>
<div class="line">        <span class="keywordflow">if</span> (strcmp(in_szPropertyName, <span class="stringliteral">&quot;PropertyKey&quot;</span>) == 0)</div>
<div class="line">        {</div>
<div class="line">            <span class="comment">// Access the property set</span></div>
<div class="line">            int32_t value = 0;</div>
<div class="line">            <span class="keywordflow">if</span> (m_propertySet.GetValueInt32(in_guidPlatform, in_szPropertyName, value))</div>
<div class="line">            {</div>
<div class="line">                <span class="comment">// Do something with the value</span></div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp(in_szPropertyName, <span class="stringliteral">&quot;OtherPropertyKey&quot;</span>) == 0)</div>
<div class="line">        {</div>
<div class="line">            <span class="comment">// ...</span></div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line">};</div>
</div><!-- fragment --><h1><a class="anchor" id="wwiseplugin_complexproperty"></a>
Custom Data</h1>
<p>If your plug-in uses complex data such as curves, graphs, and so on, the property set will likely be insufficient to represent this type of data. However, a custom data mechanism is provided to handle this type of complex data. The requirements for custom data are the following:</p>
<ul>
<li>Implement a loading and saving mechanism as XML data, e.g., path to a binary file, base64 content, etc.</li>
<li>Notify Wwise when this data changes for it to be reloaded in the Sound engine</li>
<li>Implement a serializing function for writing into Sound Banks as parameters for the Sound Engine plug-in.</li>
</ul>
<p>These can be accomplished by implementing specific interfaces:</p>
<ul>
<li><code>AK::Wwise::Plugin::CustomData</code> : Provides the necessary interface for loading and saving your custom data in the Wwise project</li>
<li><code>AK::Wwise::Plugin::RequestHost</code> : Provides functions to notify the Authoring (<code>AK::Wwise::Plugin::Host::NotifyInternalDataChanged()</code>)</li>
</ul>
<table border="0" cellspacing="0" cellpadding="2">
<tr>
<td valign="top"><img src="images/Note.gif" alt="" class="inline"/></td><td><b>Note:</b> The plug-in has full control over its custom data, hence you should not define anything in the plug-in's XML for this type of data. </td></tr>
</table>
<h2><a class="anchor" id="wwiseplugin_complexproperty_provide"></a>
Providing Custom Data</h2>
<p>The plug-in data can be provided by implementing <code>AK::Wwise::Plugin::CustomData::GetPluginData</code>. Custom parameter IDs need to be defined and must correspond to the ones used for reading this data in the sound engine part of the plug-in when <code>AK::IAkPluginParam::SetParam</code> is called.</p>
<h2><a class="anchor" id="wwiseplugin_complexproperty_persist"></a>
Initializing and Persisting Custom Data</h2>
<p>The custom data is owned by the plug-in instance and must be loaded and saved to the project for persistence. It is strongly suggested, when possible, to use plain XML to represent as much of the complex data as possible to ease the merging process when projects are under source control. It is still possible to save more complex data by marshalling it to base64 or by saving a file for which the relative path to the project root is persisted as an XML element.</p>
<p>The functions to implement for persistence are provided by <code>AK::Wwise::Plugin::CustomData</code>:</p>
<ul>
<li><code>AK::Wwise::Plugin::CustomData::InitFromWorkunit()</code> receives a <code>AK::Wwise::Plugin::XmlReader</code> used to unmarshall the custom data</li>
<li><code>AK::Wwise::Plugin::CustomData::Save()</code> receives a <code>AK::Wwise::Plugin::XmlWriter</code> used to marshall the custom data</li>
</ul>
<p>If a plug-in instance's custom data is successfully saved in a project's Work Unit, <code>InitFromWorkunit</code> will be called during project loading, soon after its instantiation. There are two other ways custom data plug-ins can be initialized by Authoring, depending on the circumstances. These are mutually exclusive; only one will be called at instantiation.</p>
<ul>
<li><code>AK::Wwise::Plugin::CustomData::InitToDefault()</code> when Authoring initializes a new instance, or no saved data is available</li>
<li><code>AK::Wwise::Plugin::CustomData::InitFromInstance()</code> when the user duplicates a plug-in instance, when the plug-in instance is deleted, or an redo is performed.</li>
</ul>
<table border="0" cellspacing="0" cellpadding="2">
<tr>
<td valign="top"><img src="images/Note.gif" alt="" class="inline"/></td><td><b>Note:</b> The plug-in code is responsible for handling the versioning of its data, so it is strongly suggested to add versioning information in your custom data. Make sure your plug-in knows what versions of the data it can or cannot load to avoid crashes and data corruption. </td></tr>
</table>
<h2><a class="anchor" id="wwiseplugin_complexproperty_notify"></a>
Custom Data Notification</h2>
<p>To inform Wwise that your particular data has changed so that this data can be saved or transferred to the sound engine, use the <code>AK::Wwise::Plugin::Host::NotifyInternalDataChanged()</code> function. You can specify a ParamID to limit the notification to a subset of your data. We will refer to this internal data unit as a "complex property". You can also use <code>AK::IAkPluginParam::ALL_PLUGIN_DATA_ID</code> to specify that all your data has changed.</p>
<table border="0" cellspacing="0" cellpadding="2">
<tr>
<td valign="top"><img src="images/Note.gif" alt="" class="inline"/></td><td><b>Note:</b> Do not use NotifyInternalDataChanged for properties declared in the XML and handled by the Property Set. The notification is done automatically when setter functions from <code>AK::Wwise::Plugin::PropertySet</code> are used. </td></tr>
</table>
<p>When the user modifies custom properties and the plug-in calls NotifyInternalDataChanged, Wwise will call its <code>AK::Wwise::Plugin::CustomData::GetPluginData</code> method to obtain the data block that will be transferred to the sound engine part of the plug-in. The sound engine plug-in will receive the block through <code>AK::IAkPluginParam::SetParam</code> with the ParamID specified in NotifyInternalDataChanged.</p>
<table border="0" cellspacing="0" cellpadding="2">
<tr>
<td valign="top"><img src="images/Note.gif" alt="" class="inline"/></td><td><b>Note:</b> If you use custom properties, you must handle <code>AK::IAkPluginParam::ALL_PLUGIN_DATA_ID</code> in <code>AK::IAkPluginParam::SetParam</code> and <code>AK::Wwise::Plugin::CustomData::GetPluginData</code>. It will be used at least once, when the plug-in is played the first time. </td></tr>
</table>
<h2><a class="anchor" id="wwiseplugin_displaynames"></a>
Property Display Names and Values</h2>
<p>A "user-friendly" name can be associated to each property by specifying the "DisplayName" attribute in the Property tag (see Properties Element for more details). However, if you have dynamic properties that take a different meaning depending on context, you can implement the <code>AK::Wwise::Plugin::PropertyDisplayNames</code> interface and specify display names for properties and named values.</p>
<p>Display names are displayed in several places in the user interface. These include the RTPC Manager, the Multi Editor, the edit menu for the undo/redo commands after a property change, and so on.</p>
<p>The <code>in_pszPropertyName</code> parameter in <code>AK::Wwise::Plugin::PropertyDisplayName::DisplayNameForProp</code> corresponds to the property name specified in the plug-in's XML definition file (<a class="el" href="plugin_xml.html">Wwise Plug-in XML Description Files</a>). Here is a sample implementation of this method:</p>
<div class="fragment"><div class="line"><span class="keywordtype">bool</span> MySourcePlugin::DisplayNameForProp(</div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">char</span>* in_pszPropertyName,</div>
<div class="line">    <span class="keywordtype">char</span>* out_pszDisplayName,</div>
<div class="line">    uint32_t in_unCharCount)<span class="keyword"> const</span></div>
<div class="line"><span class="keyword"></span>{</div>
<div class="line">    <span class="keywordflow">if</span> (strcmp(in_pszPropertyName, <span class="stringliteral">&quot;Frequency&quot;</span>) == 0)</div>
<div class="line">    {</div>
<div class="line">        strncpy(out_pszDisplayName, <span class="stringliteral">&quot;Frequency (KHz)&quot;</span>, in_unCharCount);</div>
<div class="line">        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line">}</div>
</div><!-- fragment --><p>If a certain property has non-numeric values, such as a boolean property that means On/Off or Yes/No, or an enumeration for a curve type, or if <em>some</em> values have a special meaning, you can specify custom text to be displayed for some or all of the property's possible values in your implementation of the <code>AK::Wwise::Plugin::PropertyDisplayName::DisplayNamesForPropValues()</code> method. The custom text will be used in the RTPC graph view for those values on the Y axis.</p>
<table border="0" cellspacing="0" cellpadding="2">
<tr>
<td valign="top"><img src="images/Note.gif" alt="" class="inline"/></td><td><p class="starttd"><b>Note:</b> The format of the string that is built by <code>AK::Wwise::Plugin::PropertyDisplayName::DisplayNamesForPropValues()</code> is the same as that of the "Options" attribute you can specify on Combo Box controls in your dialog (Refer to <a class="el" href="wwiseplugin_dialog_guide.html">Wwise Plug-in Dialog Reference</a> for more information). The string contains value/text pairs separated by commas, and each pair contains the numeric value and the text separated by a colon. For example:</p>
<ul>
<li>Boolean property: "0:Off,1:On"</li>
<li>Numeric property seen as an enumeration: "0:Low Pass,1:High Pass,2:Band Pass"</li>
<li>Numeric property with some values that have a special meaning: "-100:Left,0:Center,100:Right"</li>
</ul>
<p class="endtd">For <code>bool</code> properties, use 0 for <code>false</code> and 1 for <code>true</code> on the value side of a value/text pair. </p>
</td></tr>
</table>
<p>In the sample code below, the name is retrieved from the plug-in's resources:</p>
<div class="fragment"><div class="line"><span class="comment">// Allow Wwise to retrieve a user friendly name for that property&#39;s value (for example, RTPCs).</span></div>
<div class="line"><span class="keywordtype">bool</span> MySourcePlugin::DisplayNamesForPropValues(</div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">char</span> * in_pszPropertyName,</div>
<div class="line">    <span class="keywordtype">char</span> * out_pszValuesName,</div>
<div class="line">    uint32_t in_unCharCount</div>
<div class="line">)<span class="keyword"> const</span></div>
<div class="line"><span class="keyword"></span>{</div>
<div class="line">    <span class="keywordflow">if</span> (strcmp(in_pszPropertyName, szSmoothMode) == 0)</div>
<div class="line">    {</div>
<div class="line">        strncpy(out_pszValuesName, <span class="stringliteral">&quot;0:LowRes,1:HiRes&quot;</span>, in_unCharCount);</div>
<div class="line">        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line">}</div>
</div><!-- fragment --> </div></div><!-- contents -->
</div><!-- PageDoc -->
<div class="ttc" id="aclass_a_k_1_1_wwise_1_1_plugin_1_1_v1_1_1_data_writer_html"><div class="ttname"><a href="class_a_k_1_1_wwise_1_1_plugin_1_1_v1_1_1_data_writer.html">AK.Wwise::Plugin::V1::DataWriter</a></div><div class="ttdoc">Interface used to write data during sound bank generation.</div><div class="ttdef"><b>Definition:</b> HostDataWriter.h:245</div></div>
<div class="ttc" id="aclass_a_k_1_1_wwise_1_1_plugin_1_1_v1_1_1_notifications_1_1_property_set___a90d279b0b03eed79cb10a5b56b0aff90_html_a90d279b0b03eed79cb10a5b56b0aff90"><div class="ttname">AK.Wwise::Plugin::V1::Notifications::PropertySet_::NotifyPropertyChanged</div><div class="ttdeci">virtual void NotifyPropertyChanged(const GUID &amp;in_guidPlatform, const char *in_pszPropertyName)</div><div class="ttdoc">This function is called by Wwise when a plug-in property changes.</div><div class="ttdef"><b>Definition:</b> HostPropertySet.h:2414</div></div>
<div class="ttc" id="aclass_a_k_1_1_wwise_1_1_plugin_1_1_v1_1_1_data_writer_a9626e22ea3ba15a71d2cf51ac2332693_html_a9626e22ea3ba15a71d2cf51ac2332693"><div class="ttname">AK.Wwise::Plugin::V1::DataWriter::WriteInt32</div><div class="ttdeci">bool WriteInt32(int32_t in_value)</div><div class="ttdoc">Writes a 32-bit signed integer value.</div><div class="ttdef"><b>Definition:</b> HostDataWriter.h:323</div></div>
<div class="ttc" id="aclass_a_k_1_1_wwise_1_1_plugin_1_1_v1_1_1_audio_plugin_html"><div class="ttname"><a href="class_a_k_1_1_wwise_1_1_plugin_1_1_v1_1_1_audio_plugin.html">AK.Wwise::Plugin::V1::AudioPlugin</a></div><div class="ttdoc">Wwise API for general Audio Plug-in's backend.</div><div class="ttdef"><b>Definition:</b> AudioPlugin.h:133</div></div>
<div class="ttc" id="aclass_a_k_1_1_wwise_1_1_plugin_1_1_v1_1_1_audio_plugin_ae59a3955718ed3bbde0521da21cd8539_html_ae59a3955718ed3bbde0521da21cd8539"><div class="ttname">AK.Wwise::Plugin::V1::AudioPlugin::GetBankParameters</div><div class="ttdeci">virtual bool GetBankParameters(const GUID &amp;in_guidPlatform, DataWriter &amp;in_dataWriter) const</div><div class="ttdoc">Obtains parameters that will be written to a bank.</div><div class="ttdef"><b>Definition:</b> AudioPlugin.h:228</div></div>
<div class="ttc" id="astruct_g_u_i_d_html"><div class="ttname"><a href="struct_g_u_i_d.html">GUID</a></div><div class="ttdef"><b>Definition:</b> PluginHelpers.h:45</div></div>
</body>
</html>


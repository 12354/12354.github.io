<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.20"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Optimizing Memory Allocation</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="akdoxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Wwise SDK 2023.1.0 - Windows
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.20 -->
</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Optimizing Memory Allocation </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><table border="0" cellspacing="0" cellpadding="2">
<tr>
<td valign="top"><img src="images/Note.gif" alt="" class="inline"/></td><td><b>Note:</b> The memory manager has been completely revised for Wwise version 2019.2. The following instructions only apply from version 2019.2 onwards. </td></tr>
</table>
<p>The Wwise sound engine memory allocations can be divided into two broad groups: a number of fixed-size allocations made upon sound engine initialization, and dynamic allocations.</p>
<h1><a class="anchor" id="fixed_allocs"></a>
Fixed-size allocations</h1>
<p>Some of the fixed-size allocations can be controlled via initialization parameters. Here is a list of init-time memory allocation controls:</p>
<ul>
<li>AkInitSettings::uMaxNumPaths</li>
<li>AkInitSettings::uCommandQueueSize</li>
<li>AkInitSettings::uMonitorQueuePoolSize (Debug/Profile only)</li>
<li>AkDeviceSettings::uIOMemorySize</li>
</ul>
<p>Of these, uIOMemorySize is the most significant. This streaming buffer size should be set based on the maximum number of concurrently played streamed sounds, the bitrate of the sounds, and the safety timeline of the streaming sounds. The default value of 8 MB may be seen as a waste of memory for some games, but it is best to start out large and trim down as your memory usage becomes clearer. For more information on streaming buffer memory, refer to <a class="el" href="streamingmanager_settings.html">Audiokinetic Stream Manager Initialization Settings</a>.</p>
<h1><a class="anchor" id="dynamic_allocs"></a>
Dynamic allocations</h1>
<p>See the documentation for memory allocation categories in AkMemID to get a better understanding of the various types of allocations made by the sound engine. Statistics for each of these categories are reported in the Memory tab of the Wwise Advanced Profiler View.</p>
<p>Debug-only allocations are made in the Monitor Queue and Profiler categories, which are not used in the Release version. Subtracting the size of these categories should give you a good idea of the release-version memory usage. </p><table border="0" cellspacing="0" cellpadding="2">
<tr>
<td valign="top"><img src="images/Note.gif" alt="" class="inline"/></td><td><b>Note:</b> You can also explore sound engine memory usage in the Memory tab by capturing profile information from Wwise itself without connecting to a game. </td></tr>
</table>
<h1><a class="anchor" id="soundengine_initialization_advanced_soundengine_pool_memory_mising"></a>
Running out of Memory</h1>
<p>Total memory allocation by the sound engine can be controlled via the AkMemSettings::uMemAllocationSizeLimit initialization parameter. With a limit set, the sound engine reacts differently to out-of-memory conditions depending on when the condition occurs. For example, here is what happens when memory is missing in the following scenarios:</p>
<ul>
<li>Sound engine initialization: The initialization fails.</li>
<li>Loading a bank: The bank load fails.</li>
<li>Starting a transition for a parameter, such as volume: The transition is skipped and the parameter jumps directly to the target value without transition.</li>
<li>Playing a sound: Either the play fails or another playback with lower priority is stopped to free memory for the new one.</li>
</ul>
<h1><a class="anchor" id="soundengine_initialization_advanced_soundengine_pool_memory_mising_Detect"></a>
Detecting Memory Problems</h1>
<p>When you use the Wwise Profiler, a warning notification is sent to the capture log for every allocation failure that occurs in the game. You can check this list of notifications to find out which memory categories were involved in reaching the memory limit during gameplay.</p>
<h1><a class="anchor" id="soundengine_initialization_advanced_soundengine_pool_memory_mising_why"></a>
Causes of High Memory Usage</h1>
<p>The following items can cause high memory usage:</p><ul>
<li>Loading banks increases Object and Media memory usage. Note that each bank uses a different amount of memory. Memory used by a bank in the Object category does not depend on the physical size of the bank but on the number of structures and events that it contains.</li>
<li>Some effects, including reverb and delay, consume a larger amount of Processing memory when playing.</li>
<li>Playing multiple sounds at once drastically increases the amount of Processing memory used.</li>
<li>Sending multiple actions in a short amount of time increases the amount of Object memory used.</li>
<li>Registering game objects, setting "per object" parameters, and setting object positions all use a small amount of memory. However, be aware that unused game objects must be unregistered to free up this memory. Otherwise, the amount of memory being used constantly increases.</li>
</ul>
<table border="0" cellspacing="0" cellpadding="2">
<tr>
<td valign="top"><img src="images/Warning.gif" alt="" class="inline"/></td><td><b>Warning:</b> When performing tests to check peak memory usage, you must ensure that the current speaker setup configuration used by the game is set to its maximum configuration (for example, 7.1 on PC when using the system audio output device). This is necessary because the sound engine performs some optimizations when the speaker setup is stereo, and therefore will use less memory than in multi-channel configurations. </td></tr>
</table>
<p>More details are available in the following sections:</p><ul>
<li>Initializing the Memory Manager</li>
<li><a class="el" href="memorymanager.html">Memory Manager</a></li>
</ul>
<dl class="section see"><dt>See also</dt><dd><ul>
<li><a class="el" href="goingfurther_optimizingmempools_reducing_memory.html">Tips to Reduce Memory Usage</a> </li>
</ul>
</dd></dl>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</body>
</html>


<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>dbo.spAddAttribut</title>
    <style>
        body { font-family: Arial, sans-serif; line-height: 1.6; margin: 0; padding: 20px; }
        h1 { color: #333; }
        pre { background-color: #f4f4f4; padding: 10px; border-radius: 5px; overflow-x: auto; }
    </style>
</head>
<body>
    <h1>dbo.spAddAttribut</h1>
    <p><strong>Description:</strong> Mit der Procedure kann ein Attribut mit Beschreibung hinzugefügt werden.</p>
    <p><strong>Long Description:</strong> Keine ausführliche Beschreibung hinterlegt.</p>
    <p><strong>Created At:</strong> 2024-01-12 03:32:03</p>
    <p><strong>Updated At:</strong> 2024-01-12 03:32:03</p>
    <h2>Code:</h2>
    <pre><code>CREATE PROCEDURE [dbo].[spAddAttribut]( @cWertVarChar AS NVARCHAR( MAX ) , 
                                         @cName AS VARCHAR( MAX ) , 
                                         @cGruppeName AS NVARCHAR( MAX ) , 
                                         @cBeschreibung AS NVARCHAR( MAX ) , 
                                         @kSprache AS INT,
								 @kFeldTyp AS INT,
								 @nIstStandard AS INT,
								 @nIstMehrsprachig AS INT,
								 @cWertListe AS NVARCHAR(MAX),
								 @nBezugstyp AS INT)
AS
BEGIN
    IF( SELECT COUNT( * )
        FROM
             dbo.tAttribut AS Attribut
             JOIN dbo.tAttributSprache AS Sprache ON Sprache.kAttribut = Attribut.kAttribut
                                                 AND Attribut.cGruppeName = @cGruppeName
                                                 AND Attribut.nBezugstyp = @nBezugstyp
                                                 AND Attribut.nIstFreifeld = 0
                                                 AND Sprache.cName = @cName ) = 0
        BEGIN
            INSERT INTO dbo.tAttribut(
            --kAttribut - this column value is auto-generated
            dbo.tAttribut.nIstMehrsprachig , 
            dbo.tAttribut.nIstFreifeld , 
            dbo.tAttribut.nSortierung , 
            dbo.tAttribut.cBeschreibung , 
            dbo.tAttribut.nBezugstyp , 
            dbo.tAttribut.nAusgabeweg , 
            dbo.tAttribut.nIstStandard , 
            dbo.tAttribut.kFeldTyp , 
            dbo.tAttribut.cRegEx , 
            dbo.tAttribut.cGruppeName )
            VALUES(
                  -- kAttribut - int
                  @nIstMehrsprachig , 
                  -- nIstMehrsprachig - tinyint
                  0 , 
                  -- nIstFreifeld - tinyint
                  1 , 
                  -- nSortierung - int
                  @cBeschreibung , 
                  -- cBeschreibung - varchar
                  @nBezugstyp , 
                  -- nBezugstyp - tinyint
                  0 , 
                  -- nAusgabeweg - tinyint
                  @nIstStandard , 
                  -- nIstStandard - tinyint
                  @kFeldTyp , 
                  -- kFeldTyp - int
                  N&#39;&#39; , 
                  -- cRegEx - nvarchar
                  @cGruppeName -- cGruppeName - nvarchar
                  );

            INSERT INTO dbo.tAttributSprache( dbo.tAttributSprache.kAttribut , 
                                              dbo.tAttributSprache.kSprache , 
                                              dbo.tAttributSprache.cName , 
                                              dbo.tAttributSprache.cWertListe )
            VALUES( @@IDENTITY , 
                    -- kAttribut - int
                    @kSprache , 
                    -- kSprache - int
                    @cName , 
                    -- cName - varchar
                    @cWertListe -- cWertListe - varchar
                  );
        END;
END;</code></pre>
</body>
</html>
